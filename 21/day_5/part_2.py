print(len((lambda L,I:set().union(*[set().union(*[I(l,r) for r in L if r!=l]) for l in L]))([[[int(r)+int(i)*1j for r,i in [p.split(',')]][0] for p in l.split("->")] for l in open("input").readlines() if l],lambda l,r:(lambda p,q,P,R:P(p,R)&P(q,R))(l,r,lambda a,R: set(x+y*1j for x,y in R(*a)),lambda B,E:(lambda b,e,R:zip(R(b.real,e.real),R(b.imag,e.imag)) if (b.real!=e.real)and(b.imag!=e.imag) else zip(R(b.real,e.real),[b.imag]*round(abs(b.real-e.real)+1)) if b.real!=e.real else zip([b.real]*round(abs(b.imag-e.imag)+1),R(b.imag,e.imag)))(B,E,lambda b,e:range(round(b),round(e)+(1 if b<=e else -1),1 if b<=e else -1))))))
